<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>–í—ã–±–æ—Ä –ø–æ–¥–∞—Ä–∫–∞</title>

<style>
:root {
  --blue: #2430b8;
  --blue-dark: #1a218f;
  --green: #1db46a;
  --bg: #f3f5fb;
  --text: #111;
  --muted: #f3f5fb;
  --page-bg: #f3f5fb;
  --card-bg: #ffffff;
  --card-bg-active: #f8f9fd;
}

* {
  box-sizing: border-box;
  font-family: -apple-system, BlinkMacSystemFont, "Inter", "Segoe UI", sans-serif;
}

body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
}

/* ===== –°–ò–ù–Ø–Ø –®–ê–ü–ö–ê ===== */
.header {
  background: linear-gradient(180deg, #2b38d6, var(--blue));
  color: #fff;
  padding: 40px 16px 120px;
  text-align: center;
  position: sticky;
  top: 0;
  z-index: 1;
}

.header h1 {
  margin: 0;
  font-size: 22px;
}

.header p {
  margin: 8px 0 0;
  font-size: 14px;
  opacity: .85;
}

/* ===== –¢–ê–ô–ú–ï–† ===== */
.timer {
  margin-top: 16px;
  background: #fff;
  color: #111;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  border-radius: 999px;
  font-size: 13px;
  font-weight: 500;
}

/* ===== –ë–ï–õ–´–ô –°–õ–û–ô ===== */
.content {
  margin-top: -80px;
  padding: 24px 16px 40px;
  position: relative;
  z-index: 2;
  background: #fff;
  border-radius: 24px 24px 0 0;
  min-height: calc(100vh - 120px);
}

.card-list {
  max-width: 420px;
  margin: 0 auto;
  display: flex;
  flex-direction: column;
  gap: 14px;
  background: #fff;
}

/* ===== –ö–ê–†–¢–û–ß–ö–ê –ü–û–î–ê–†–ö–ê (–û–ë–ù–û–í–õ–ï–ù–û) ===== */
/* –ò–∑–º–µ–Ω—è–µ–º –±–∞–∑–æ–≤—ã–π —Å—Ç–∏–ª—å –∫–∞—Ä—Ç–æ—á–∫–∏ */
.gift {
  background: #fafbff;
  border-radius: 18px;
  padding: 14px; 
  display: block;
  position: relative;
  cursor: pointer;
  border: 1px solid #e5e7eb; 
  box-shadow: 0 2px 6px rgba(0,0,0,0.03);
  transition: background-color 0.2s ease;
  /*border: 2px solid transparent; /* –ß—Ç–æ–±—ã –∫–∞—Ä—Ç–æ—á–∫–∞ –Ω–µ –ø—Ä—ã–≥–∞–ª–∞ –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —Ä–∞–º–∫–∏ –•–ò–¢–∞ */
  contain: layout;
  transform: translateZ(0);
}

/* –≠—Ñ—Ñ–µ–∫—Ç—ã –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –¢–û–õ–¨–ö–û –¥–ª—è –ü–ö */
@media (hover: hover) {
  .gift{
    transition: background-color 0.2s ease, box-shadow 0.2s ease, transform 0.2s ease;
  }
  .gift:hover {
    background: #f5f7fd;
    box-shadow: 0 12px 30px rgba(0,0,0,.12);
    transform: translateY(-2px);
  }
  .gift:hover .gift-icon {
    color: #2563eb;
  }
}

/* –ú–ì–ù–û–í–ï–ù–ù–´–ô —Å—Ç–∏–ª—å –¥–ª—è —Ä–∞—Å–∫—Ä—ã—Ç–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ (–¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ –ü–ö) */
.gift.is-open {
  background-color: #f0f2f5 !important; /* –¢–æ—Ç —Å–∞–º—ã–π "—á—É—Ç—å —Ç–µ–º–Ω–µ–µ" —Ü–≤–µ—Ç */
  border-color: #dbeafe;
}

/* –ï—Å–ª–∏ —ç—Ç–æ –•–ò–¢ –∏ –æ–Ω –æ—Ç–∫—Ä—ã—Ç, –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —á—É—Ç—å –¥—Ä—É–≥–æ–π –æ—Ç—Ç–µ–Ω–æ–∫ */
.gift.is-hit.is-open {
  background-color: #ecf7f1 !important; 
  border-color: var(--green);
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –∏–∫–æ–Ω–∫–∏ –≤–Ω—É—Ç—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ */
.gift.is-open .gift-icon {
  color: #2563eb;
}

.gift-summary {
  display: flex;
  align-items: center;
  gap: 14px;
}

.logo {
  min-width: 92px;
  height: 56px;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  color: #fff;
}

.logo.green { background: #0b2f2f; }
.logo.blue { background: #0d2d9a; }
.logo.orange { background: #111; }
.logo.yellow { background: #ffe031; color:#111; }

.gift-title {
  font-size: 14px;
  font-weight: 600;
}

.gift-icon {
  margin-left: auto;
  font-size: 20px;
  color: #cbd5e1;
  transition: color .25s;
}

.gift:hover .gift-icon {
  color: #2563eb;
}

/* ===== –°–∫—Ä—ã—Ç—ã–µ –î–µ—Ç–∞–ª–∏ –ê–∫—Ü–∏–∏ (–ù–û–í–´–ï –°–¢–ò–õ–ò) ===== */
.gift-details {
  display: grid;
  grid-template-rows: 0fr;
  /* –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç—É—é –∫—Ä–∏–≤—É—é –±–µ–∑ —Ä—ã–≤–∫–æ–≤ */
  transition: grid-template-rows 0.3s ease-out;
  /* –ü–æ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º –±—Ä–∞—É–∑–µ—Ä—É, —á—Ç–æ –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å—Å—è —Ç–æ–ª—å–∫–æ —à–∞–±–ª–æ–Ω —Å–µ—Ç–∫–∏ */
  will-change: grid-template-rows;
}

/* –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞—Å–∫—Ä—ã—Ç–∏—è –¥–µ—Ç–∞–ª–µ–π */
.gift-details.open {
  grid-template-rows: 1fr;
}

.gift-details-inner {
  overflow: hidden;
  opacity: 0;
  transition: opacity 0.25s ease-in;
  /* –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–æ—è–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞, —á—Ç–æ–±—ã —Ä–∞–º–∫–∞ –Ω–∞—á–∞–ª–∞ –µ—Ö–∞—Ç—å —Ä–∞–Ω—å—à–µ */
  transition-delay: 0.1s; 
}

.gift-details h3 {
  font-size: 16px;
  margin: 0 0 8px;
}

.gift-details.open .gift-details-inner {
  opacity: 1;
}

.gift-details-content-box {
  padding-top: 14px;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤–Ω—É—Ç—Ä–∏ —Ä–∞—Å–∫—Ä—ã—Ç–æ–≥–æ –±–ª–æ–∫–∞ */
.details-progress {
  height: 8px;
  background: #f5f5f5;
  border-radius: 4px;
  margin: 8px 0 16px;
}

.details-progress-bar {
  height: 100%;
  background: var(--green);
  border-radius: 4px;
}

.details-info {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 13px;
  color: var(--muted);
  margin-bottom: 16px;
}

.details-users {
  display: flex;
  align-items: center;
  gap: 4px;
}

/* ===== –•–ò–¢ ===== */
.hit {
  position: absolute;
  top: -10px; /* –ß—É—Ç—å –≤—ã—à–µ, —á—Ç–æ–±—ã —Å–∏–¥–µ–ª–æ –Ω–∞ —Ä–∞–º–∫–µ */
  left: 50%;
  transform: translateX(-50%);
  background: var(--green);
  color: #fff;
  font-size: 11px;
  padding: 2px 10px;
  border-radius: 999px;
  z-index: 11;
  display: block;
  font-weight: 600;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ .gift, 
   —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç –∑–µ–ª–µ–Ω–æ–π —Ä–∞–º–∫–∏ */
.gift.is-hit {
    /* –ü–æ–ª–Ω–∞—è –∑–µ–ª–µ–Ω–∞—è –æ–±–≤–æ–¥–∫–∞ */
    border: 2px solid var(--green);
    /* –ö–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ–º —à–∏—Ä–∏–Ω—É —Ä–∞–º–∫–∏, —á—Ç–æ–±—ã –∫–∞—Ä—Ç–æ—á–∫–∞ –Ω–µ –¥–µ—Ä–≥–∞–ª–∞—Å—å –ø–æ —Ä–∞–∑–º–µ—Ä—É */
    margin: -2px; 
    /* –ß—É—Ç—å –±–æ–ª—å—à–µ –æ—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫–∏, —á—Ç–æ–±—ã —Ç–µ–∫—Å—Ç –Ω–µ –ø—Ä–∏–ª–∏–ø –∫ –ª–µ–π–±–ª—É */
    padding-top: 18px;
}

.gift.is-hit::before {
    display: none;
}

/* ===== –ú–û–î–ê–õ–ö–ê (–û–°–¢–ê–í–õ–ï–ù–ê, –ù–û –ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø) ===== */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.55);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 10;
}

.modal.active {
  display: flex;
}

.modal-card {
  background: #fff;
  width: 92%;
  max-width: 380px;
  max-height: 90vh;
  border-radius: 22px;
  overflow-y: auto;
  padding: 16px;
  position: relative;
}

.modal-close {
  position: absolute;
  top: 12px;
  right: 12px;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: #f1f5f9;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

.modal h2 {
  margin-top: 8px;
  font-size: 18px;
}

.primary-btn {
  width: 100%;
  height: 48px;
  border-radius: 14px;
  background: #2430b8;
  color: #fff;
  border: none;
  font-weight: 600;
  margin-top: 14px;
}
</style>
</head>

<body>

<header class="header">
  <h1>–í—ã–±–µ—Ä–∏—Ç–µ (1) –ø–æ–¥–∞—Ä–æ–∫</h1>
  <p>–£ –≤–∞—Å –µ—Å—Ç—å 5 –º–∏–Ω—É—Ç</p>

  <div class="timer" id="timer">
    ‚è± –û—Å—Ç–∞–ª–æ—Å—å 04:59
  </div>
</header>

<section class="content">
  <div class="card-list" id="cardList">
    </div>
</section>

<div class="modal" id="modal">
  <div class="modal-card">
    <div class="modal-close" onclick="closeModal()">‚úï</div>
    <div id="modalContent">
      </div>
  </div>
</div>

<script>
// Initialize Telegram WebApp
if (window.Telegram && window.Telegram.WebApp) {
  window.Telegram.WebApp.ready();
  window.Telegram.WebApp.expand();
}

const API_BASE = window.location.origin;

/* ===== –¢–ê–ô–ú–ï–† ===== */
let time = 300000; // 5 –º–∏–Ω—É—Ç = 300000 –º—Å
const timerEl = document.getElementById('timer');

const interval = setInterval(() => {
  const minutes = Math.floor(time / 60000);
  const seconds = Math.floor((time % 60000) / 1000);
  const ms = Math.floor((time % 1000) / 10); // –¥–≤–µ —Ü–∏—Ñ—Ä—ã –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥

  const m = String(minutes).padStart(2, '0');
  const s = String(seconds).padStart(2, '0');
  const msStr = String(ms).padStart(2, '0');

  timerEl.textContent = `‚è± –û—Å—Ç–∞–ª–æ—Å—å ${m}:${s}.${msStr}`;

  if (time <= 0) {
    clearInterval(interval);
  } else {
    time -= 10;
  }
}, 10);

/* ===== –ó–ê–ì–†–£–ó–ö–ê –ö–ê–†–¢–û–ß–ï–ö ===== */
let topPromotionIds = [];

async function loadPromotions() {
  try {
    const response = await fetch(`${API_BASE}/api/promotions`);
    const data = await response.json();
    
    // Get top promotions for HIT marks
    const topResponse = await fetch(`${API_BASE}/api/top-promotions`);
    const topData = await topResponse.json();
    topPromotionIds = topData.map(p => p.id);
    
    renderPromotions(data.promotions);
  } catch (error) {
    console.error('Error loading promotions:', error);
    document.getElementById('cardList').innerHTML = '<div style="text-align:center;padding:40px;color:#dbdbdb;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–¥–∞—Ä–∫–æ–≤</div>';
  }
}

function renderPromotions(promotions) {
  const cardList = document.getElementById('cardList');
  if (promotions.length === 0) {
    cardList.innerHTML = '<div style="text-align:center;padding:40px;color:#dbdbdb;">–ü–æ–¥–∞—Ä–∫–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</div>';
    return;
  }
  
  cardList.innerHTML = promotions.map(promo => {
    const isHit = topPromotionIds.includes(promo.id);
    const logoClass = ['green', 'blue', 'orange', 'yellow'][promo.id % 4];
    const logoText = promo.title.substring(0, 4).toUpperCase();
    
    let logoHtml = '';
    if (promo.preview_image_file_id) {
      logoHtml = `<img src="${API_BASE}/api/image/${promo.preview_image_file_id}" 
        style="width:92px;height:56px;border-radius:12px;object-fit:cover;" 
        onerror="this.outerHTML='<div class=\\'logo ${logoClass}\\'>${logoText}</div>'">`;
    } else {
      logoHtml = `<div class="logo ${logoClass}">${logoText}</div>`;
    }
    
    // –í–°–¢–ê–í–õ–Ø–ï–ú –ö–û–ù–¢–ï–ù–¢ –°–†–ê–ó–£ (–°–∫—Ä—ã—Ç—ã–π)
    // –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: –º—ã –ø–µ—Ä–µ–¥–∞–µ–º promo.link –∏ promo.id –ø—Ä—è–º–æ –≤ –∫–Ω–æ–ø–∫—É
    return `
  <div class="gift ${isHit ? 'is-hit' : ''}" id="gift-${promo.id}" onclick="togglePromotionDetails(${promo.id})">
    ${isHit ? '<span class="hit">–•–ò–¢</span>' : ''} 
    
    <div class="gift-summary">
       ${logoHtml}
       <div class="gift-title">${promo.title}</div>
       <div class="gift-icon">üéÅ</div>
    </div>

    <div class="gift-details" id="details-${promo.id}">
       <div class="gift-details-inner">
         <div class="gift-details-content-box">
            <p style="font-size:14px; color:#111; margin:0 0 16px; line-height:1.5;">${promo.description || ''}</p>
            <button class="primary-btn" onclick="event.stopPropagation(); claimPromotion(${promo.id}, '${promo.link}')">
              –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–∞—Ä–æ–∫
            </button>
         </div>
       </div>
    </div>
  </div>
`;
  }).join('');
}

/* ===== –§–£–ù–ö–¶–ò–ò –ú–û–î–ê–õ–ö–ò (–ù–ï –ò–°–ü–û–õ–¨–ó–£–Æ–¢–°–Ø, –ù–û –û–°–¢–ê–í–õ–ï–ù–´) ===== */
function closeModal() {
  document.getElementById('modal').classList.remove('active');
}

const tg = window.Telegram?.WebApp;
if (tg) {
  tg.ready();
  tg.expand(); // –†–∞—Å–∫—Ä—ã–≤–∞–µ–º –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
  // –û—Ç–∫–ª—é—á–∞–µ–º –Ω–∞—Ç–∏–≤–Ω—ã–π —Å–≤–∞–π–ø –∑–∞–∫—Ä—ã—Ç–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–∫—Ä–æ–ª–ª–∞)
  // tg.enableClosingConfirmation(); 
}

/* ===== –†–ê–°–ö–†–´–¢–ò–ï –î–ï–¢–ê–õ–ï–ô –ê–ö–¶–ò–ò (–ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê) ===== */
async function togglePromotionDetails(promoId) {
  const detailsEl = document.getElementById(`details-${promoId}`);
  const giftCardEl = document.getElementById(`gift-${promoId}`);
  const isCurrentlyOpen = detailsEl.classList.contains('open');

  // 1. –¢–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ—Ç–¥–∞—á–∞ (Haptic Feedback) - –¥–µ–ª–∞–µ—Ç "–ø—Ä–∏—è—Ç–Ω–æ" –∏ "–±—ã—Å—Ç—Ä–æ"
  if (tg && tg.HapticFeedback) {
    tg.HapticFeedback.impactOccurred('light');
  }

  // 2. –ï—Å–ª–∏ —É–∂–µ –æ—Ç–∫—Ä—ã—Ç–æ ‚Äî –∑–∞–∫—Ä—ã–≤–∞–µ–º
  if (isCurrentlyOpen) {
    detailsEl.classList.remove('open');
    giftCardEl.classList.remove('is-open');
    return;
  }
  
  // 3. –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º –Ω–æ–≤–æ–µ ‚Äî –∑–∞–∫—Ä—ã–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º requestAnimationFrame, —á—Ç–æ–±—ã –±—Ä–∞—É–∑–µ—Ä —É—Å–ø–µ–ª –æ—Ç—Ä–∏—Å–æ–≤–∞—Ç—å –∑–∞–∫—Ä—ã—Ç–∏–µ –¥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è –Ω–æ–≤–æ–≥–æ
  requestAnimationFrame(() => {
    document.querySelectorAll('.gift-details.open').forEach(el => {
      el.classList.remove('open');
      el.closest('.gift').classList.remove('is-open');
    });

    // 4. –û—Ç–∫—Ä—ã–≤–∞–µ–º —Ç–µ–∫—É—â—É—é (–ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å, CSS —Å–¥–µ–ª–∞–µ—Ç –æ—Å—Ç–∞–ª—å–Ω–æ–µ)
    giftCardEl.classList.add('is-open');
    detailsEl.classList.add('open');
  });

  // 5. –õ–æ–≥–∏–∫–∞ —Å–∫—Ä–æ–ª–ª–∞ (–û–°–¢–û–†–û–ñ–ù–û)
  // –í TWA –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Å–∫—Ä–æ–ª–ª —á–∞—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –¥–µ—Ä–≥–∞–Ω—å–µ.
  // –õ—É—á—à–µ —Å–∫—Ä–æ–ª–ª–∏—Ç—å –¢–û–õ–¨–ö–û –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç —Ä–µ–∞–ª—å–Ω–æ —É—à–µ–ª –∑–∞ —ç–∫—Ä–∞–Ω, –∏ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π.
  setTimeout(() => {
    const rect = giftCardEl.getBoundingClientRect();
    const isInViewport = (
        rect.top >= 0 &&
        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight)
    );

    if (!isInViewport) {
       giftCardEl.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
  }, 400); // –ñ–¥–µ–º –ø–æ–∫–∞ –ø—Ä–æ–π–¥–µ—Ç –∞–Ω–∏–º–∞—Ü–∏—è CSS (0.35s) + –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–ø–∞—Å

  // 6. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
  let userId = tg?.initDataUnsafe?.user?.id || null;
  fetch(`${API_BASE}/api/promotions/${promoId}/click`, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({action: 'view', user_id: userId})
  }).catch(console.error);
}

function claimPromotion(promoId, link) {
  let userId = null;
  if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initDataUnsafe) {
    userId = window.Telegram.WebApp.initDataUnsafe.user?.id;
  }
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ Telegram, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω, –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ –≤—Å–µ–≥–æ
  if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.openLink) {
      window.Telegram.WebApp.openLink(link);
  } else {
      // –§–æ–ª–±—ç–∫ –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞
      window.open(link, '_blank');
  }

  // 3. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ —Ñ–æ–Ω–µ (–Ω–µ –∂–¥–µ–º –æ—Ç–≤–µ—Ç–∞ —á–µ—Ä–µ–∑ await)
  fetch(`${API_BASE}/api/promotions/${promoId}/click`, {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({action: 'redirect', user_id: userId})
  }).catch(error => {
    // –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É —Ç–∏—Ö–æ, —Ç–∞–∫ –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —É—à–µ–ª –ø–æ —Å—Å—ã–ª–∫–µ
    console.error('Error logging click (background):', error);
  });
}


// Load promotions on page load
loadPromotions();
</script>

</body>
</html>